<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'; media-src 'self';">
  <title>Leituras do Bloco | Leitura de HidrÃ´metro</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="logorecibo.png" type="image/png">

</head>
<body>
  <script>
    if (localStorage.getItem("logado") !== "true") location.href = "index.html";
  </script>

  <div class="toolbar">
	    <button class="voltar" aria-label="Voltar para o painel" onclick="window.location.href='dashboard.html'">ğŸ”™ Voltar</button>
	    <div class="acoes">
	      
<button type="button" onclick="exportarLeituraAtual()">ğŸ“¤ Exportar Leitura Atual</button>
	      <input type="file" id="importar-leitura-arquivo" accept=".xlsx" style="display:none" onchange="importarLeituraAtual(event)" />
	      <button type="button" onclick="document.getElementById('importar-leitura-arquivo').click()">ğŸ“¥ Importar Leitura Atual (XLSX)</button>
        <button type="button" onclick="exportarHistorico(Number(new URLSearchParams(location.search).get('id')))">ğŸ“¥ Exportar HistÃ³rico (XLSX)</button>
        <input type="file" id="importar-historico-arquivo" accept=".json" style="display:none" onchange="importarHistorico(Number(new URLSearchParams(location.search).get('id')), event)" />
        <button type="button" onclick="document.getElementById('importar-historico-arquivo').click()">ğŸ“¤ Importar HistÃ³rico (JSON)</button>
      <button type="button" class="btn-danger" onclick="resetarBlocoPerguntar()">ğŸ—‘ï¸ Resetar Bloco</button>
      <button type="button" onclick="(function(){ const id=new URLSearchParams(location.search).get('id'); location.href='boletos.html?id='+encodeURIComponent(id||'0'); })()">ğŸ§¾ Boletos (imprimir)</button>
    </div>
  </div>

 <main id="bloco-detalhes" class="conteudo">
		  </main>

  <!-- Modal de Captura de Foto -->
  <div id="modal-captura-foto" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close-button" onclick="fecharModalCapturaFoto()">&times;</span>
      <h2>Capturar Foto do HidrÃ´metro</h2>
      <p>Apartamento: <strong id="foto-apt-nome"></strong></p>
      
      <div id="camera-view">
        <video id="video-stream" width="320" height="240" autoplay></video>
        <button onclick="capturarFoto()">Tirar Foto</button>
      </div>
      
      <div id="upload-view" style="display:none;">
        <input type="file" accept="image/*" onchange="uploadFoto(event)">
      </div>

      <canvas id="canvas-foto" width="320" height="240" style="display:none;"></canvas>
      <img id="foto-preview" src="" alt="PrÃ©via da Foto" style="display:none; max-width: 100%; height: auto;">
      
      <div class="modal-actions">
        <button onclick="salvarFoto()">Salvar Foto</button>
        <button onclick="alternarModoCaptura()">Alternar para Upload</button>
      </div>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>
