<!-- 
  Projeto: Leitura de HidrÃ´metro
  VersÃ£o: v1.0.0
  Data: 10/11/2025
  DescriÃ§Ã£o: Dashboard principal com lista de blocos.
-->

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard | Leitura de HidrÃ´metro</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="logorecibo.png" type="image/png">
</head>
<body>
  <script>
    if (localStorage.getItem("logado") !== "true") location.href = "index.html";
  </script>

  <header class="topbar">
    <h1>Blocos Cadastrados</h1>
    <div class="topbar-actions">
      <button type="button" onclick="abrirModalImpressaoRecibo()">ğŸ–¨ï¸ Imprimir Recibo</button>
      <button type="button" onclick="criarBloco()">+ Adicionar Bloco</button>
      <button type="button" onclick="toggleCalculadora()">ğŸ§® Calculadora</button>
      
      <button type="button" onclick="exportarDados()">ğŸ’¾ Exportar Dados</button>
      <input type="file" id="importar-arquivo" accept=".json,application/json" style="display:none" onchange="importarDados(event)" />
      <button type="button" onclick="document.getElementById('importar-arquivo').click()">ğŸ“¥ Importar Dados</button>
	      <button type="button" onclick="gerarTemplateImportacao()">ğŸ“„ Gerar Modelo ImportaÃ§Ã£o</button>
      <button type="button" onclick="abrirModalAlterarSenha()">ğŸ”‘ Alterar Senha</button>
      <button type="button" class="btn-danger" onclick="logout()">Sair</button>
      <button type="button" class="btn-danger" onclick="hardResetConfirm()">âš ï¸ Hard Reset</button>
    </div>
  </header>

  <main id="blocos-container">
    <div id="calculator-container" class="calculator-container" style="display:none;">
			      <h2>Calculadora de Conta de Ãgua</h2>
			      <p>Preencha os campos abaixo para calcular o valor da sua conta.</p>
		
			      <div class="input-group">
			        <label for="consumo">Consumo (mÂ³):</label>
			        <input type="number" id="consumo" placeholder="Ex: 15" onchange="calcularValor(); atualizarTextoExplicativo();" />
			      </div>
		
			      <div class="input-group">
			        <label for="valorMinimo">Valor MÃ­nimo (R$):</label>
			        <input type="number" id="valorMinimo" step="0.01" value="68.40" onchange="calcularValor(); atualizarTextoExplicativo();" />
			      </div>
		
			      <div class="input-group">
			        <label for="valorM3">Valor por mÂ³ excedente (R$):</label>
			        <input type="number" id="valorM3" step="0.01" value="8.59" onchange="calcularValor(); atualizarTextoExplicativo();" />
			      </div>
		
			      <div class="input-group">
			        <label for="valorTotal">Total a pagar (R$):</label>
			        <input type="text" id="valorTotal" readonly />
			      </div>

          <div id="textoExplicativo" class="result-box"></div>

          <div>
			      <a id="whatsappLink" href="#" target="_blank">
			        <button>Enviar cÃ¡lculo via WhatsApp</button>
			      </a>
			    </div>
		    </div>
    <div id="lista-blocos">

    </div>
  </main>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <!-- Modal de AlteraÃ§Ã£o de Senha -->
  <div id="modal-alterar-senha" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close-button" onclick="fecharModalAlterarSenha()">&times;</span>
      <h2>Alterar Senha</h2>
      <form id="form-alterar-senha">
        <label for="nova-senha">Nova Senha:</label>
        <input type="password" id="nova-senha" required>
        <label for="confirmar-senha">Confirmar Nova Senha:</label>
        <input type="password" id="confirmar-senha" required>
        <button type="submit">Salvar Nova Senha</button>
      </form>
      <p id="senha-erro" style="color: red;"></p>
    </div>
  </div>

  <!-- Modal de ImpressÃ£o de Recibo -->
  <div id="modal-impressao-recibo" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close-button" onclick="fecharModalImpressaoRecibo()">&times;</span>
      <h2>Imprimir Recibo por Bloco e MÃªs</h2>
      <form id="form-impressao-recibo" onsubmit="imprimirReciboSelecionado(event)">
        <label for="select-bloco-recibo">Selecione o Bloco:</label>
        <select id="select-bloco-recibo" required onchange="popularMesesRecibo()"></select>
        
        <label for="select-mes-recibo">Selecione o MÃªs:</label>
        <select id="select-mes-recibo" required></select>
        
        <button type="submit">Gerar Recibo para ImpressÃ£o</button>
      </form>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
